"\n---\n\r\n#apiVersion: v1\r\n#kind: PersistentVolumeClaim\r\n#metadata:\r\n#  name:\
  \ efs-oam-prod\r\n#spec:\r\n#  accessModes:\r\n#    - ReadWriteMany\r\n#  storageClassName:\
  \ efs-sc\r\n#  resources:\r\n#    requests:\r\n#      storage: 1Mi\r\n\n---\n\r\n\
  # Zoo Keeper\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  name:\
  \ isa-zk\r\nspec:\r\n  serviceName: zk-service\r\n  replicas: 1\r\n  selector:\r\
  \n    matchLabels:\r\n      app: isa-zk\r\n  template:\r\n    metadata:\r\n    \
  \  labels:\r\n        app: isa-zk\r\n    spec:\r\n      containers:\r\n      - name:\
  \ isa-zk\r\n        imagePullPolicy: Always\r\n        image: bitnami/zookeeper:3.8.0\
  \      #agirish/zookeeper:3.6.0\r\n        securityContext:\r\n          runAsNonRoot:\
  \ true\r\n          runAsUser: 1000\r\n               \r\n        ports:\r\n   \
  \     - containerPort: 2181\r\n          name: client\r\n        - containerPort:\
  \ 2888\r\n          name: server\r\n        - containerPort: 3888\r\n          name:\
  \ leader-election          \r\n        env:\r\n          - name: ALLOW_ANONYMOUS_LOGIN\r\
  \n            value: \"yes\"        \r\n          - name: ZOO_TICK_TIME\r\n    \
  \        value: \"4000\"\r\n          - name: ZOO_INIT_LIMIT\r\n            value:\
  \ \"100\"\r\n          - name: ZOO_SYNC_LIMIT\r\n            value: \"10\"\r\n \
  \         - name: ZOO_MAX_CNXNS\r\n            value: \"0\"\r\n          - name:\
  \ ZOO_MAX_CLIENT_CNXNS\r\n            value: \"600\"\r\n          - name: ZOO_AUTOPURGE_INTERVAL\r\
  \n            value: \"0\"\r\n          - name: ZOO_HEAP_SIZE\r\n            value:\
  \ \"1536\"\r\n          - name: ZOO_MAX_SESSION_TIMEOUT\r\n            value: \"\
  100000\"\r\n        resources: \r\n           limits:\r\n              cpu: 700m\r\
  \n              memory: 2500Mi\r\n           requests:\r\n              cpu: 700m\r\
  \n              memory: 2500Mi\r\n\n---\n\r\n# Drill \r\napiVersion: apps/v1\r\n\
  kind: StatefulSet\r\nmetadata:\r\n  name: isa-drill\r\nspec:\r\n  serviceName: isa-drill-service\r\
  \n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: isa-drill\r\n \
  \ template:\r\n    metadata:\r\n      labels:\r\n        app: isa-drill\r\n    spec:\r\
  \n      containers:\r\n      - name: isa-drill\r\n        imagePullPolicy: Always\r\
  \n        image: infobeltinc/apache-drill:1.19.0  #agirish/drill:1.17.0 # smizy/apache-drill:1.16.0-alpine\r\
  \n        env:\r\n          - name: CLUSTER_ID\r\n            value: drillcluster\r\
  \n          - name: ZK_SERVERS\r\n            value: \"zk-service:2181\"       \
  \ \r\n          - name: DRILL_CLUSTER_ID\r\n            value: drillcluster # {{\
  \ .Values.service.drillClusterID }}\r\n          - name: DRILL_HEAP\r\n        \
  \    value: \"2G\" # {{ .Values.service.drillHeap }}\r\n          - name: DRILL_MAX_DIRECT_MEMORY\r\
  \n            value: \"6G\" # {{ .Values.service.maxDirectMemory }}\r\n        \
  \  - name: DRILL_ZOOKEEPER_QUORUM\r\n            value: \"zk-service:2181\" # {{\
  \ .Values.service.drillZkHosts }}\r\n          - name: DRILL_ZK_ROOT\r\n       \
  \     value: drillcluster # {{ .Values.service.drillClusterID }}\r\n          -\
  \ name: DRILL_HTTP_PORT\r\n            value: \"8047\"\r\n          - name: DRILL_USER_SERVER_PORT\r\
  \n            value: \"31010\"\r\n        ports:\r\n        - containerPort: 8047\
  \ # {{ .Values.service.drillHttpPort }}\r\n          name: http\r\n        - containerPort:\
  \ 31010 # {{ .Values.service.drillUserPort }}\r\n          name: userport\r\n  \
  \      - containerPort: 31011 # {{ .Values.service.drillControlPort }}\r\n     \
  \     name: controlport\r\n        - containerPort: 31012 # {{ .Values.service.drillDataPort\
  \ }}\r\n          name: dataport\r\n        tty: true  \r\n        volumeMounts:\r\
  \n        - mountPath: /var/lib/isa\r\n          name: efs-oam-prod\r\n        -\
  \ mountPath: /opt/drill/conf/drill-override.conf\r\n          name: drill-config-cm\r\
  \n          subPath: drill-override.conf\r\n        - mountPath: /opt/drill/conf/drill-env.sh\r\
  \n          name: drill-config-cm\r\n          subPath: drill-env.sh\r\n       \
  \ resources: \r\n            limits:\r\n               cpu: 700m\r\n           \
  \    memory: 5500Mi\r\n            requests:\r\n               cpu: 700m\r\n   \
  \            memory: 4500Mi\r\n      volumes:\r\n        - name: efs-oam-prod\r\n\
  \          persistentVolumeClaim:\r\n            claimName: efs-oam-prod\r\n   \
  \     - name: drill-config-cm\r\n          configMap:\r\n            name: drill-config-cm\
  \            \r\n      initContainers:\r\n        - name: zk-available\r\n     \
  \     image: busybox\r\n          command: ['sh', '-c', 'until nc -z zk-service\
  \ 2181; do echo Waiting for ZK to come up; sleep 5; done; ']\r\n\n---\n\r\n# OAM\
  \ ONBOARDING UI\r\n\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n\
  \  name: isa-onboarding\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\
  \n      app: isa-onboarding\r\n  template:\r\n    metadata:\r\n      labels:\r\n\
  \        app: isa-onboarding\r\n    spec:\r\n      containers:      \r\n      -\
  \ name: isa-onboarding\r\n        image: \"997742452154.dkr.ecr.us-west-2.amazonaws.com/infobelt/oam-onboarding:0.0.1-SNAPSHO2\"\
  \r\n        imagePullPolicy: IfNotPresent\r\n        ports:\r\n          - containerPort:\
  \ 9090\r\n        env:\r\n          - name: ORION_SERVER\r\n            value: \"\
  onboarding\"\r\n          - name: SPRING_DATASOURCE_DRIVERCLASSNAME\r\n        \
  \    value: oracle.jdbc.driver.OracleDriver\r\n          - name: SPRING_DATASOURCE_URL\r\
  \n            value: jdbc:oracle:thin:@oam-ui.c6njtcwgnr85.us-west-2.rds.amazonaws.com:1521:OPENSKYE\r\
  \n          - name: SPRING_DATASOURCE_USERNAME\r\n            value: oam\r\n   \
  \       - name: SPRING_DATASOURCE_PASSWORD\r\n            value: changeme     \r\
  \n          - name: SERVER_PORT\r\n            value: \"9090\"\r\n          - name:\
  \ SERVER_SERVLET_CONTEXT_PATH\r\n            value: \"/webapp\"\r\n#          -\
  \ name: SERVER_SSL_ENABLED\r\n#            value: \"false\"\r\n        volumeMounts:\r\
  \n          - name: efs-oam-prod\r\n            mountPath: /var/lib/isa\r\n    \
  \    resources:\r\n             limits:\r\n                 cpu: 400m\r\n      \
  \           memory: 2000Mi\r\n             requests:\r\n                 cpu: 300m\r\
  \n                 memory: 2000Mi\r\n      terminationGracePeriodSeconds: 10\r\n\
  \      volumes:\r\n        - name: efs-oam-prod\r\n          persistentVolumeClaim:\r\
  \n            claimName: efs-oam-prod           \r\n\r\n\n---\n\r\n# OAM UI\r\n\r\
  \napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: isa-ui\r\nspec:\r\
  \n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: isa-ui\r\n  template:\r\
  \n    metadata:\r\n      labels:\r\n        app: isa-ui\r\n    spec:\r\n      containers:\
  \      \r\n      - name: isa-ui\r\n        image: \"997742452154.dkr.ecr.us-west-2.amazonaws.com/infobelt/oam-saas:4.52.22\"\
  \r\n        imagePullPolicy: IfNotPresent\r\n        ports:\r\n          - containerPort:\
  \ 8090\r\n        env:\r\n          - name: ORION_SERVER\r\n            value: \"\
  ui\"\r\n          - name: SERVER_PORT\r\n            value: \"8090\"\r\n       \
  \   - name: SERVER_SERVLET_CONTEXT_PATH\r\n            value: \"/webapp\"\r\n  \
  \        - name: SERVER_SSL_ENABLED\r\n            value: \"false\"\r\n        \
  \  - name: SKYE_HOSTNAME\r\n            value: \"isa-server\"\r\n        resources:\r\
  \n             limits:\r\n                 cpu: 400m\r\n                 memory:\
  \ 2000Mi\r\n             requests:\r\n                 cpu: 400m\r\n           \
  \      memory: 2000Mi               \r\n        volumeMounts:\r\n          - name:\
  \ efs-oam-prod\r\n            mountPath: /var/lib/isa      \r\n      terminationGracePeriodSeconds:\
  \ 10\r\n      volumes:\r\n        - name: efs-oam-prod\r\n          persistentVolumeClaim:\r\
  \n            claimName: efs-oam-prod         \r\n\n---\n            \r\napiVersion:\
  \ apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: isa-server\r\nspec:\r\n  replicas:\
  \ 1\r\n  selector:\r\n    matchLabels:\r\n      app: isa-server    \r\n  template:\r\
  \n    metadata:\r\n      labels:\r\n        app: isa-server  \r\n    spec:\r\n \
  \     containers:        \r\n      - name: isa-server\r\n        image: \"997742452154.dkr.ecr.us-west-2.amazonaws.com/infobelt/oam-saas:4.52.22\"\
  \r\n        imagePullPolicy: IfNotPresent\r\n        ports:\r\n          - containerPort:\
  \ 8080\r\n        env:\r\n          - name: ORION_SERVER\r\n            value: \"\
  server\"\r\n          - name: SPRING_DATASOURCE_DRIVERCLASSNAME\r\n            value:\
  \ oracle.jdbc.driver.OracleDriver\r\n          - name: SPRING_DATASOURCE_URL\r\n\
  \            value: jdbc:oracle:thin:@oam-poc.c6njtcwgnr85.us-west-2.rds.amazonaws.com:1521:OPENSKYE\r\
  \n          - name: SPRING_DATASOURCE_USERNAME\r\n            value: openskye\r\n\
  \          - name: SPRING_DATASOURCE_PASSWORD\r\n            value: changeme\r\n\
  \          - name: SPRING_DATA_JEST_URI\r\n            value: http://localhost:9200\r\
  \n          - name: SPRING_JPA_DATABASE-PLATFORM\r\n            value: org.hibernate.dialect.Oracle12cDialect\r\
  \n          - name: SPRING_JPA_DATABASE\r\n            value: ORACLE\r\n       \
  \   - name: SERVER_PORT\r\n            value: \"8080\"\r\n          - name: SERVER_SERVLET_CONTEXT_PATH\r\
  \n            value: \"/webapp\"\r\n          - name: SPRING_LIQUIBASE_CHANGE_LOG\r\
  \n            value: \"classpath:/db/changelog/db.changelog-master.xml\"\r\n   \
  \       - name: SPRING_LIQUIBASE_ENABLED\r\n            value: \"true\"\r\n    \
  \      - name: BOOTSTRAP_CONFIGURATION_DOMAIN\r\n            value: \"Skye\"\r\n\
  \          - name: BOOTSTRAP_CONFIGURATION_ORGANIZATION\r\n            value: \"\
  openskye.org\"\r\n          - name: DRILL_URL\r\n            value: \"jdbc:drill:zk=zk-service:2181/drill/drillcluster\"\
  \r\n          - name: ZOOKEEPER_SERVERS\r\n            value: \"zk-service:2181\"\
  \ \r\n          - name: ZOOKEEPER_PATHS\r\n            value: \"/orion/workers_latch,/orion/workers_latch2,/orion/workers_latch3\"\
  \r\n          - name: ZOOKEEPER_MEMBERSHIP_PATHS\r\n            value: \"/orion/workers_group,/orion/workers_group2,/orion/workers_group3\"\
  \r\n          - name: ELASTICSEARCH_HOST\r\n            value: isa-elastic-service\r\
  \n          - name: ELASTICSEARCH_PORT\r\n            value: \"9300\"\r\n      \
  \    - name: ELASTICSEARCH_REST_API_PORT\r\n            value: \"9200\"\r\n    \
  \      - name: ELASTICSEARCH_USERNAME\r\n            value: \"elastic\"\r\n    \
  \      - name: ELASTICSEARCH_PASSWORD ## for 4x-qa env the pwd is changeme, qa1\
  \ env the pwd is changeme12\r\n            value: \"changeme12\"\r\n          -\
  \ name: ELASTICSEARCH_BASICAUTHWITHSSL\r\n            value: \"true\"\r\n      \
  \    - name: ELASTICSEARCH_TRUSTSTOREPATH\r\n            value: \"/usr/share/elasticsearch/config/certs/elastic-certificates.p12\"\
  \r\n          - name: SPRING_RABBITMQ_PORT\r\n            value: \"5672\"\r\n  \
  \        - name: SPRING_RABBITMQ_HOST\r\n            value: 18.224.23.228\r\n  \
  \        - name: SPRING_RABBITMQ_USERNAME\r\n            value: admin\r\n      \
  \    - name: SPRING_RABBITMQ_PASSWORD\r\n            value: password\r\n       \
  \   - name: RABBITMQ_EXCHANGE\r\n            value: orion_regent_project_exchange\r\
  \n          - name: RABBITMQ_AMQFLAG\r\n            value: \"true\"\r\n        volumeMounts:\r\
  \n          - name: efs-oam-prod\r\n            mountPath: /var/lib/isa\r\n    \
  \      - name: efs-oam-prod  \r\n            mountPath: /usr/share/elasticsearch/config/certs\r\
  \n        resources:\r\n             limits:\r\n                 cpu: 600m\r\n \
  \                memory: 4000Mi\r\n             requests:\r\n                 cpu:\
  \ 600m\r\n                 memory: 3000Mi\r\n      terminationGracePeriodSeconds:\
  \ 10\r\n      volumes:\r\n        - name: efs-oam-prod\r\n          persistentVolumeClaim:\r\
  \n            claimName: efs-oam-prod\r\n\r\n\n---\n# OAM Wokers \n\nmetadata:\n\
  \  name: isa-workers\napiVersion: apps/v1\nkind: StatefulSet\nspec:\n  serviceName:\
  \ isa-workers-service\n  replicas: 2\n  selector:\n    matchLabels:\n      app:\
  \ isa-workers\n  template:\n    metadata:\n      labels:\n        app: isa-workers\n\
  \    spec:\n      containers:\n      - name: isa-worker\n        image: 997742452154.dkr.ecr.us-west-2.amazonaws.com/infobelt/oam-saas:3.3.23\n\
  \        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort:\
  \ 8080\n        - containerPort: 8080\n        env:\n        - name: ORION_SERVER\n\
  \          value: worker\n        - name: SPRING_DATASOURCE_DRIVERCLASSNAME\n  \
  \        value: oracle.jdbc.driver.OracleDriver\n        - name: SPRING_DATASOURCE_URL\n\
  \          value: jdbc:oracle:thin:@oam-poc.c6njtcwgnr85.us-west-2.rds.amazonaws.com:1521:zee\n\
  \        - name: SPRING_DATASOURCE_USERNAME\n          value: zeeadmin\n       \
  \ - name: SPRING_DATASOURCE_PASSWORD\n          value: zee123\n        - name: SPRING_DATA_JEST_URI\n\
  \          value: http://localhost:9200\n        - name: SPRING_JPA_DATABASE-PLATFORM\n\
  \          value: org.hibernate.dialect.Oracle12cDialect\n        - name: SPRING_JPA_DATABASE\n\
  \          value: ORACLE\n        - name: WORKER_CONFIGURATION_HOSTNAME\n      \
  \    valueFrom:\n            fieldRef:\n              apiVersion: v1\n         \
  \     fieldPath: metadata.name\n        - name: DRILL_URL\n          value: jdbc:drill:zk=zk-service:2181/drill/drillcluster\n\
  \        - name: ZOOKEEPER_SERVERS\n          value: zk-service:2181\n        -\
  \ name: ZOOKEEPER_PATHS\n          value: /orion/workers_latch,/orion/workers_latch2,/orion/workers_latch3\n\
  \        - name: ZOOKEEPER_MEMBERSHIP_PATHS\n          value: /orion/workers_group,/orion/workers_group2,/orion/workers_group3\n\
  \        - name: WORKER_CONFIGURATION_ZOOKEEPER_PATH\n          value: /orion/workers_latch\n\
  \        - name: WORKER_CONFIGURATION_ZOOKEEPER_MEMBERSHIP_PATH\n          value:\
  \ /orion/workers_group\n        - name: ELASTICSEARCH_HOST\n          value: isa-elastic-service\n\
  \        - name: ELASTICSEARCH_PORT\n          value: 9300\n        - name: ELASTICSEARCH_REST_API_PORT\n\
  \          value: 9200\n        - name: ELASTICSEARCH_USERNAME\n          value:\
  \ elastic\n        - name: ELASTICSEARCH_PASSWORD\n          value: changeme12\n\
  \        - name: ELASTICSEARCH_BASICAUTHWITHSSL\n          value: true\n       \
  \ - name: ELASTICSEARCH_TRUSTSTOREPATH\n          value: /usr/share/elasticsearch/config/certs/elastic-certificates.p12\n\
  \        - name: JAVA_OPTS\n          value: -Xms1024m -Xmx4096m\n        - name:\
  \ WORKER_CONFIGURATION_DELIMITED_FILE_ARCHIVE_FOLDER\n          value: /var/lib/isa/delimitedFileArchive\n\
  \        - name: WORKER_CONFIGURATION_KEEP_ARCHIVING_EVEN_AFTER_AN_EXCEPTION_IS_THROWN\n\
  \          value: true\n        - name: WORKER_CONFIGURATION_KEEP_ARCHIVING_EVEN_AFTER_VERIFICATION_FAILED\n\
  \          value: true\n        volumeMounts:\n        - name: efs-oam-prod\n  \
  \        mountPath: /var/lib/isa\n        - name: efs-oam-prod\n          mountPath:\
  \ /usr/share/elasticsearch/config/certs\n        resources:\n          limits:\n\
  \            cpu: 600m\n            memory: 3000Mi\n          requests:\n      \
  \      cpu: 600m\n            memory: 3000Mi\n      terminationGracePeriodSeconds:\
  \ 10\n      volumes:\n      - name: efs-oam-prod\n        persistentVolumeClaim:\n\
  \          claimName: efs-oam-prod\n\n---\n\r\napiVersion: apps/v1\r\nkind: Deployment\r\
  \nmetadata:\r\n  name: isa-elastic\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n\
  \    matchLabels:\r\n      app: isa-elastic\r\n  template:\r\n    metadata:\r\n\
  \      labels:\r\n        app: isa-elastic\r\n    spec:\r\n      containers:\r\n\
  \      - name: elastic\r\n        image: docker.elastic.co/elasticsearch/elasticsearch:7.17.2\r\
  \n        securityContext:\r\n          capabilities:\r\n          #drop:\r\n  \
  \        #- ALL\r\n          runAsNonRoot: true\r\n          runAsUser: 1000\r\n\
  \        env:\r\n          - name: discovery.type\r\n            value: single-node\r\
  \n          - name: cluster.name\r\n            value: elasticsearch\r\n       \
  \   - name: ELASTICSEARCH_HOST\r\n            value: isa-elastic-service\r\n   \
  \       - name: ELASTIC_PASSWORD\r\n            value: changeme12\r\n          -\
  \ name: ELASTICSEARCH_PORT\r\n            value: \"9300\"\r\n          - name: ELASTICSEARCH_REST_API_PORT\r\
  \n            value: \"9200\"\r\n          - name: ES_JAVA_OPTS\r\n            value:\
  \ \"-Xms1g -Xmx3g\"\r\n          - name: node.max_local_storage_nodes\r\n      \
  \      value: \"10\"\r\n        volumeMounts:\r\n          - name: efs-oam-prod\r\
  \n#          - name: elastic-certificates\r\n            mountPath: /usr/share/elasticsearch/config/certs\r\
  \n          - name: config\r\n            mountPath: /usr/share/elasticsearch/config/elasticsearch.yml\r\
  \n            readOnly: true\r\n            subPath: elasticsearch.yml\r\n     \
  \     - name: efs-oam-prod\r\n            mountPath: /usr/share/elasticsearch/data\r\
  \n        resources:\r\n         limits:\r\n           cpu: 500m\r\n           memory:\
  \ 2000Mi\r\n         requests:\r\n           cpu: 500m\r\n           memory: 2000Mi\r\
  \n\r\n      initContainers:\r\n      - name: create-certs\r\n        image: docker.elastic.co/elasticsearch/elasticsearch:7.17.2\r\
  \n        command: [ 'sh' , '-c' , \"  bin/elasticsearch-certutil ca --silent --pass\
  \ '' --out elastic-stack-ca.p12 ; sleep 20 ;  bin/elasticsearch-certutil cert --silent\
  \ --ca elastic-stack-ca.p12 -name 'CN=isa-elastic-service' --ca-pass '' --pass ''\
  \ --out config/certs/elastic-certificates.p12 ; sleep 20 ; cp -rpf /usr/share/elasticsearch/elastic-stack-ca.p12\
  \ /usr/share/elasticsearch/config/certs/ \" ]\r\n        securityContext:\r\n  \
  \        capabilities:\r\n          #drop:\r\n          #- ALL\r\n          runAsNonRoot:\
  \ true\r\n          runAsUser: 1000\r\n        volumeMounts:\r\n          - name:\
  \ efs-oam-prod\r\n#          - name: elastic-certificates\r\n            mountPath:\
  \ /usr/share/elasticsearch/config/certs\r\n\r\n      volumes:\r\n        - name:\
  \  config\r\n          configMap:\r\n            name: myeschart7172-config # update\
  \ the configmap name as per chart version and name\r\n#        - name: elastic-certificates\r\
  \n#          emptyDir: {}      \r\n        - name: efs-oam-prod\r\n          persistentVolumeClaim:\r\
  \n            claimName: efs-oam-prod            \r\n      imagePullSecrets: []\r\
  \n      securityContext:\r\n        fsGroup: 1000\r\n              \r\n\n---\n\r\
  \n"
